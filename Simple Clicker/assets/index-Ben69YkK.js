var t=Object.defineProperty,e=(e,s,i)=>((e,s,i)=>s in e?t(e,s,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[s]=i)(e,"symbol"!=typeof s?s+"":s,i);import{r as s}from"./phaser-UvlxNa5i.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();var i=s();const o=(t,e)=>Math.round(t*e*10)/(10*e);class n{constructor(t,s,i,o){e(this,"name"),e(this,"costs"),e(this,"cps"),e(this,"multiplier"),e(this,"quantity",0),this.name=t,this.costs=s,this.cps=i,this.multiplier=o}tryBuy(t){let e=-1;return t>=this.costs&&(e=this.costs,this.quantity+=1,this.costs=o(this.costs*this.multiplier,2)),e}get totalCPS(){return o(this.cps*this.quantity,2)}}const h=[new n("Carte au trésor",10,.1,1.1),new n("Ticket à gratter",50,.3,1.15),new n("Commerce",100,1,1.5),new n("Crypto",1e3,15,2),new n("Banque",2500,50,2)];class a extends Phaser.GameObjects.Text{constructor(t,e,s,i,o,n){super(t,e,s,i,o),this.setInteractive(),this.on("pointerover",(()=>{this.setColor("#ff0000")})),this.on("pointerout",(()=>{this.setColor("#ffffff")})),this.on("pointerdown",n),t.add.existing(this)}}class r extends Phaser.GameObjects.Container{constructor(t,s,i,o,n){super(t),e(this,"setBackgroundWidth"),e(this,"centerText");const h=()=>`Cost: ${o.costs}\nHave: ${o.quantity}\nCPS: ${o.totalCPS}`,r=t.add.image(0,0,n).setOrigin(0).setName("background"),c=new Phaser.GameObjects.Text(t,0,0,o.name,{}),d=new Phaser.GameObjects.Text(t,0,0,h(),{});this.centerText=t=>{t.x=r.displayWidth/2-t.width/2},this.setBackgroundWidth=t=>{r.displayWidth=t,this.centerText(c),this.centerText(l)};const l=new a(t,0,0,"Buy",{},(()=>{const e=o.tryBuy(t.getCoins);e>0&&(t.addCoin(-e),d.setText(h()),this.updateWidth())}));this.add([r,c,d,l]),this.sendToBack(r),c.setPosition(0,0),d.setPosition(0,c.height),l.setPosition(0,c.height+d.height),t.add.existing(this),this.setPosition(s,i),this.width=Math.max(c.width,d.width,l.width),this.height=c.height+d.height+l.height,r.displayHeight=this.height,r.displayWidth=this.width}updateWidth(){const t=this.getByName("background");let e=t.displayWidth;this.iterate((t=>{e=t.width>e?t.width:e})),t.displayWidth=e}}class c extends Phaser.GameObjects.Image{constructor(t,e,s,i){super(t,e,s,i),t.physics.world.enable(this),null!=this.body&&(this.body.velocity.x=200*Math.random()-100,this.body.velocity.y=-(200*Math.random()+300)),this.setScale(1.5*Math.random()+1),t.add.existing(this)}doAnim(t){null!=this.body&&(this.body.velocity.y+=1*t,this.angle+=10*t),this.y>this.scene.sys.scene.game.canvas.height&&super.removedFromScene()}}class d{constructor(t,s){e(this,"count",0),e(this,"check"),this.check=()=>{this.count>=t&&s()}}add(t){this.count+=t,this.check()}remove(t){this.count-=t,this.check()}}class l extends Phaser.GameObjects.Image{constructor(t,s,i,o,n){super(t,s,i,o),e(this,"baseScale",5),e(this,"scaleHover",1.2*this.baseScale),this.setScale(this.baseScale),this.setInteractive().on("pointerover",(()=>{this.setScale(this.scaleHover)})).on("pointerout",(()=>{this.setScale(this.baseScale)})).on("pointerdown",(()=>{this.setScale(this.baseScale)})).on("pointerup",(()=>{n(),this.setScale(this.scaleHover)})),t.add.existing(this)}}class u extends i.Scene{constructor(){super({key:"Game"}),e(this,"coins",0),e(this,"coinsText"),e(this,"coinsImage",[]),e(this,"coinThreshold",10),e(this,"generateCoinCounter",new d(this.coinThreshold,(()=>{this.generateCoin(),this.generateCoinCounter.remove(this.coinThreshold)}))),e(this,"gameWidth"),e(this,"gameHeight"),e(this,"updateBuyButtonWidth")}preload(){const{width:t,height:e}=this.sys.game.canvas;this.gameWidth=t,this.gameHeight=e,this.load.setPath("assets"),this.load.image("button_background","upg_bg.png"),this.load.image("coin","coin.png"),this.load.image("billet","billet.png")}create(){this.physics.world.gravity.set(0,0),this.coinsText=new Phaser.GameObjects.Text(this,0,0,"Default",{}),this.add.existing(this.coinsText);const t=new l(this,this.gameWidth/2,this.gameHeight/2,"billet",(()=>()=>{this.addCoin(1),this.generateCoin(),this.updateBuyButtonWidth()})());t.setPosition(this.gameWidth/2-t.width/2,this.gameHeight/2-t.height/2);const e=[];for(const s of h){const t=new r(this,0,0,s,"button_background");e.push(t)}this.updateBuyButtonWidth=()=>{let t=0;for(const n of e)t=t<n.width?n.width:t;const s=t*e.length,i=(this.gameWidth-s)/(e.length-1);let o=0;for(const n of e)n.setBackgroundWidth(t),n.setPosition(o,this.gameHeight-n.height),o+=t+i},this.updateBuyButtonWidth()}update(t,e){let s=0;for(const o of h)s+=o.totalCPS;const i=s*e/1e3;this.addCoin(i),this.generateCoinCounter.add(i);for(const o of this.coinsImage)o.doAnim(e)}addCoin(t){this.coins+=t,this.updateText()}updatePos(){}updateText(){this.coinsText.setText(`Coins: ${o(this.coins,2)}`)}generateCoin(){const t=Math.random()*this.gameWidth,e=Math.random()*this.gameHeight,s=new c(this,t,e,"coin");this.coinsImage.push(s)}get getCoins(){return this.coins}}class g extends i.Scene{constructor(){super({key:"MainMenu"})}preload(){this.load.setPath("assets"),this.load.image("background","bg.png"),this.load.image("logo","logo.png")}create(){this.add.image(512,384,"background"),this.add.image(512,350,"logo").setDepth(100),new a(this,512,490,"Launch Game",{fontFamily:"Arial Black",fontSize:38,color:"#ffffff",stroke:"#000000",strokeThickness:8,align:"center"},(()=>{this.scene.start("Game")})).setOrigin(.5).setDepth(100)}}const m={type:i.AUTO,width:1024,height:768,parent:"game-container",backgroundColor:"#028af8",scale:{mode:i.Scale.FIT,autoCenter:i.Scale.CENTER_BOTH},scene:[g,u],physics:{default:"arcade"}};document.addEventListener("DOMContentLoaded",(()=>{new i.Game({...m,parent:"game-container"})}));
